<<<<<<< HEAD
C51 COMPILER V9.59.0.0   MAIN                                                              02/24/2021 17:18:59 PAGE 1   
=======
C51 COMPILER V9.59.0.0   MAIN                                                              02/25/2021 17:42:53 PAGE 1   
>>>>>>> six commit


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\output\main.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE source\main.c LARGE OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(.\include;.\Lib
                    -rary\byd_standard_peripheral\include;.\byd_api\byd_key\include;.\byd_api\byd_mifare\include;.\byd_tool_comm;.\byd_rfid;.
                    -\mmi_inc) DEBUG PRINT(.\list\main.lst) TABS(2) OBJECT(.\output\main.obj)

line level    source

   1          /*!
   2              \file  main.c
   3              \brief main file
   4          */
   5          
   6          #include "main.h"
<<<<<<< HEAD
   7          #include "dqiot_drv.h"
   8          #include "mmi_ms.h"
   9          #include "mmi_fs.h"
  10          #include "mmi_fps.h"
  11          #include "mmi_sys.h"
  12          #include "mmi_audio.h"
  13          #include "mmi_bsp.h"
  14          #include "mmi_fm.h"
  15          //#include "stdio.h"
  16          
  17          #define ADCVDT_EN 1 /* adcµçÑ¹¼ì²â */
  18          
  19          extern uint16_t timer0_count;
  20          
  21          void system_init(void)
  22          {
  23   1        DisableGlobalInterrupt();
  24   1      
  25   1        clock_config(SYS_CLOCK_SEL);
  26   1      
  27   1        BOR_ENABLE();     //power off reset
  28   1        PLL_WAKE_TIME_SET(0); //idle mode wake time
  29   1      
  30   1      #if TRACEMODE_EN
                byd_tracemode_init(0x54, GPIO_PE4_PE5); //debug init
              #endif
  33   1      
  34   1        EnableGlobalInterrupt();
  35   1      
  36   1        XTAL_32K_ENABLE();
  37   1        delay_ms(1500);
  38   1      }
  39          
  40          int main(void)
  41          {
  42   1        unsigned char i = 0;
  43   1        WDT_DISABLE();
  44   1      
  45   1        system_init();
  46   1      
  47   1        mmi_dq_bsp_init();
  48   1      
  49   1        mmi_dq_key_init();
  50   1      
  51   1        mmi_dq_fp_init();
  52   1      
  53   1        mmi_dq_rfid_init();
C51 COMPILER V9.59.0.0   MAIN                                                              02/24/2021 17:18:59 PAGE 2   

  54   1      
  55   1        mmi_dq_aud_init();
  56   1      
  57   1        byd_adc_init();
  58   1      
  59   1        wdt_init(WDT_TIME_2304MS);
  60   1      
  61   1      #if ADCVDT_EN //¿ª»ú¼ì²â
  62   1        if (adc_VolT() == 1)
  63   1          mmi_dq_aud_play_with_id(AUD_BASE_ID_LOW_BATTERY);
  64   1      #endif
  65   1      
  66   1        //WDT_ENABLE();
  67   1      
  68   1        mmi_dq_sys_init();
  69   1      
  70   1      #if 0
                if(mmi_dq_fs_get_factory_flag() == 0)
                {
                  mmi_dq_factory_mode_test_start();
                }
                else
              #endif
  77   1        if (mmi_dq_fs_get_admin_status() == 0)
  78   1        {
  79   2          mmi_dq_sys_chg_admin_pwd();
  80   2        }
  81   1        else
  82   1          mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
  83   1      
  84   1        //printf("main while satrt");
  85   1      
  86   1        while (1)
  87   1        {
  88   2          if (SYS_STATUS_ENTER_SLEEP == mmi_dq_ms_get_sys_state())
  89   2          {
  90   3            lowpower_idle();
  91   3      
  92   3            mmi_sleep_task_proc();
  93   3          }
  94   2          else
  95   2          {
  96   3            WDT_CTRL = WDT_TIME_2304MS;
  97   3      
  98   3            mmi_task_proc();
  99   3          }
 100   2      
 101   2          mmi_dq_ms_sys_msg_handle();
 102   2      
 103   2          if (SYS_STATUS_WAIT_FOR_ENTER_SLEEP == mmi_dq_ms_get_sys_state())
 104   2            mmi_wait_sleep_task_proc();
 105   2        }
 106   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    138    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      4       1
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
C51 COMPILER V9.59.0.0   MAIN                                                              02/24/2021 17:18:59 PAGE 3   

=======
   7          #include "mmi_feature.h"
   8          #include "dqiot_drv.h"
   9          #include "mmi_ms.h"
  10          #include "mmi_fs.h"
  11          #include "mmi_fps.h"
  12          #include "mmi_sys.h"
  13          #include "mmi_audio.h"
  14          #include "mmi_bsp.h"
  15          #include "mmi_fm.h"
  16          #include "dqiot_drv_audio.h"
  17          //#include "stdio.h"
  18          
  19          extern uint16_t timer0_count;
  20          extern uint8_t audio_flag;
  21          
  22          void system_init(void)
  23          {
  24   1        DisableGlobalInterrupt();
  25   1      
  26   1        clock_config(SYS_CLOCK_SEL);
  27   1      
  28   1        BOR_ENABLE();     //power off reset
  29   1        PLL_WAKE_TIME_SET(0); //idle mode wake time
  30   1      
  31   1      #if TRACEMODE_EN
                byd_tracemode_init(0x54, GPIO_PE4_PE5); //debug init
              #endif
  34   1      
  35   1        EnableGlobalInterrupt();
  36   1      
  37   1        XTAL_32K_ENABLE();
  38   1        delay_ms(1500);
  39   1      }
  40          
  41          int main(void)
  42          {
  43   1        unsigned char i = 0;
  44   1        WDT_DISABLE();
  45   1      
  46   1        system_init();
  47   1      
  48   1        mmi_dq_bsp_init();
  49   1      
  50   1        mmi_dq_key_init();
  51   1      #ifdef __LOCK_FP_SUPPORT__
  52   1        mmi_dq_fp_init();
  53   1      #endif
C51 COMPILER V9.59.0.0   MAIN                                                              02/25/2021 17:42:53 PAGE 2   

  54   1      #ifdef __LOCK_RFID_CARD_SUPPORT__
  55   1        mmi_dq_rfid_init();
  56   1      #endif
  57   1      #ifdef __LOCK_AUDIO_SUPPORT__
  58   1        mmi_dq_aud_init();
  59   1      #endif
  60   1        byd_adc_init();
  61   1      
  62   1        wdt_init(WDT_TIME_2304MS);
  63   1      
  64   1        //WDT_ENABLE();
  65   1      
  66   1        mmi_dq_sys_init();
  67   1      
  68   1        if (0 == mmi_dq_sys_check_vbat())
  69   1        {
  70   2      #ifdef __FACTORY_TEST_SUPPORT__
                  if (mmi_dq_fs_get_factory_flag() == 0)
                  {
                    mmi_dq_factory_mode_test_start();
                  }
                  else
                  {
              #endif
  78   2            if (mmi_dq_fs_get_admin_status() == 0)
  79   2            {
  80   3              mmi_dq_sys_add_admin_pwd();
  81   3            }
  82   2            else
  83   2              mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
  84   2      #ifdef __FACTORY_TEST_SUPPORT__
                  }
              #endif
  87   2        }
  88   1      
  89   1        while (1)
  90   1        {
  91   2          if (SYS_STATUS_ENTER_SLEEP == mmi_dq_ms_get_sys_state())
  92   2          {
  93   3            lowpower_idle();
  94   3      
  95   3            mmi_sleep_task_proc();
  96   3          }
  97   2          else
  98   2          {
  99   3            WDT_CTRL = WDT_TIME_2304MS;
 100   3      
 101   3            mmi_task_proc();
 102   3          }
 103   2      
 104   2          mmi_dq_ms_sys_msg_handle();
 105   2      
 106   2          if (SYS_STATUS_WAIT_FOR_ENTER_SLEEP == mmi_dq_ms_get_sys_state())
 107   2            mmi_wait_sleep_task_proc();
 108   2        }
 109   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    131    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      4       1
C51 COMPILER V9.59.0.0   MAIN                                                              02/25/2021 17:42:53 PAGE 3   

   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
>>>>>>> six commit
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
