C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MMI_MS
OBJECT MODULE PLACED IN .\output\mmi_ms.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE mmi_src\mmi_ms.c LARGE OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(.\include;.\
                    -Library\byd_standard_peripheral\include;.\byd_api\byd_key\include;.\byd_api\byd_mifare\include;.\byd_tool_comm;.\byd_rfi
                    -d;.\mmi_inc) DEBUG PRINT(.\list\mmi_ms.lst) TABS(2) OBJECT(.\output\mmi_ms.obj)

line level    source

   1          #ifndef __MMI_MS_C__
   2          #define __MMI_MS_C__
   3          
   4          #include "string.h"
   5          #include "mmi_ms.h"
   6          #include "mmi_key.h"
   7          #include "mmi_sys.h"
   8          #include "mmi_audio.h"
   9          #include "mmi_fps.h"
  10          #include "mmi_rfid.h"
  11          #include "mmi_com.h"
  12          #include "mmi_fs.h"
  13          #include "mmi_rst.h"
  14          #include "dqiot_drv.h"
  15          #include "delay.h"
  16          #include "mmi_fs.h"
  17          #include "mmi_fm.h"
  18          #include "mmi_wifi.h"
  19          #include "dqiot_drv_wifi.h"
  20          #include <stdio.h>
  21          
  22          unsigned char input_key_1[KEY_INPUT_MAX_LEN];
  23          unsigned char input_key_2[KEY_INPUT_MAX_LEN];
  24          unsigned char key_len = 0;
  25          OPERATE_TIME opt_time = OPT_TIME_INVALID;
  26          static SYS_BASE_STATUS data sys_state = SYS_STATUS_INVALID;
  27          
  28          static unsigned char data key_last_value = KEY_INVALID;
  29          #ifdef __LOCK_RFID_CARD_SUPPORT__
  30          static unsigned char rfid_last_flag = 0;
  31          #endif
  32          #ifdef __LOCK_BUS_SUPPORT__
  33          static unsigned char admin_check_type = 0;
  34          #endif
  35          
  36          // extern void printfS(char *show, char *status);
  37          // extern void printfV(char *show, int value);
  38          
  39          /*
  40          parameter: 
  41            none
  42          return :
  43            none
  44          */
  45          void mmi_task_proc(void)
  46          {
  47   1        unsigned char touch_value = 0xFF;
  48   1        unsigned char key_value = KEY_INVALID;
  49   1      
  50   1      #ifdef __LOCK_RFID_CARD_SUPPORT__
  51   1        if (mmi_dq_sys_get_rfid_flag() == 1)
  52   1        {
  53   2          //check rfid press
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 2   

  54   2          if (mmi_dq_rfid_check() == RET_SUCESS)
  55   2          {
  56   3            if (mmi_dq_rfid_work() == RET_SUCESS)
  57   3            {
  58   4              if (rfid_last_flag == 0)
  59   4              {
  60   5                rfid_last_flag = 1;
  61   5                mmi_dq_ms_set_msg_que(QUE_EVENT_RFID, QUE_PRO_LOW, 0);
  62   5              }
  63   4            }
  64   3            else
  65   3            {
  66   4              rfid_last_flag = 0;
  67   4            }
  68   3          }
  69   2        }
  70   1      #endif
  71   1        //check key press
  72   1        touch_value = mmi_dq_key_work();
  73   1        if (touch_value != 0xFF)
  74   1        {
  75   2          key_value = mmi_dq_get_key_map(touch_value);
  76   2          if (key_value != KEY_INVALID)
  77   2          {
  78   3            if (key_last_value != key_value)
  79   3            {
  80   4              key_last_value = key_value;
  81   4              mmi_dq_ms_set_msg_que(QUE_EVENT_KEY, QUE_PRO_LOW, key_value);
  82   4            }
  83   3          }
  84   2          else
  85   2            key_last_value = KEY_INVALID;
  86   2        }
  87   1        else
  88   1          key_last_value = KEY_INVALID;
  89   1      
  90   1        if (mmi_dq_aud_get_end_flag() != 0)
  91   1          mmi_dq_ms_set_msg_que(QUE_EVENT_AUDIO_END, QUE_PRO_LOW, 0);
  92   1      
  93   1        if (mmi_dq_rst_get_state() != 0)
  94   1          mmi_dq_ms_set_msg_que(QUE_EVENT_RST, QUE_PRO_LOW, 0);
  95   1      
  96   1        if (mmi_dq_sys_get_timer2_flag() != 0)
  97   1          mmi_dq_ms_set_msg_que(QUE_EVENT_TIMER_END, QUE_PRO_LOW, 0);
  98   1      
  99   1      #ifdef __LOCK_FP_SUPPORT__
 100   1          //check fp press
 101   1          // if (mmi_dq_fp_work() != 0)
 102   1          //  mmi_dq_ms_set_msg_que(QUE_EVENT_FP, QUE_PRO_LOW, 0);
 103   1      #endif
 104   1      
 105   1      #ifdef __LOCK_WIFI_SUPPORT__
 106   1        if (mmi_dq_sys_get_wifi_check_flag() != 0)
 107   1          mmi_dq_ms_set_msg_que(QUE_EVENT_WIFI_CHECK, QUE_PRO_LOW, 0);
 108   1      #endif
 109   1      
 110   1        return;
 111   1      }
 112          
 113          /*
 114          parameter: 
 115            none
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 3   

 116          return :
 117            none
 118          */
 119          void mmi_sleep_task_proc(void)
 120          {
 121   1      #ifdef __LOCK_RFID_CARD_SUPPORT__
 122   1        unsigned char ret = 0xFF;
 123   1        static unsigned char time_count = 0;
 124   1      
 125   1        time_count++;
 126   1        if (time_count > 4)
 127   1        {
 128   2          time_count = 0;
 129   2          ret = mmi_dq_rfid_check();
 130   2        }
 131   1      #endif
 132   1      
 133   1        if (
 134   1      #ifdef __LOCK_RFID_CARD_SUPPORT__
 135   1          (ret == RET_SUCESS) ||
 136   1      #endif
 137   1          (mmi_dq_key_check() != 0) || (mmi_dq_rst_get_pin() != 0)
 138   1      #ifdef __LOCK_FP_SUPPORT__
 139   1          || (mmi_dq_fp_get_pin() == 1)
 140   1      #endif
 141   1        )
 142   1        {
 143   2          key_last_value = mmi_dq_get_key_map(dqiot_drv_get_touch_value());
 144   2          mmi_dq_sys_wake_up();
 145   2        }
 146   1      
 147   1      #ifdef __LOCK_WIFI_SUPPORT__
 148   1        //if(mmi_dq_sys_get_wifi_check_flag() != 0)
 149   1        //  mmi_dq_ms_set_msg_que(QUE_EVENT_WIFI_CHECK,QUE_PRO_LOW,0);
 150   1      #endif
 151   1      
 152   1        return;
 153   1      }
 154          
 155          /*
 156          parameter: 
 157            none
 158          return :
 159            none
 160          */
 161          void mmi_wait_sleep_task_proc(void)
 162          {
 163   1      //unsigned int timer1_count = 0;
 164   1      #ifdef __LOCK_WIFI_SUPPORT__
 165   1        if (mmi_dq_wifi_get_running_flag() == 1)
 166   1          mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
 167   1        //if((mmi_dq_rfid_check() == RET_SUCESS) || (mmi_dq_key_check() != 0) || (mmi_dq_rst_get_pin() == 0))
 168   1        else
 169   1      #endif
 170   1          if (mmi_dq_ms_get_run_flag() == 0)
 171   1        {
 172   2          mmi_dq_sys_enter_sleep();
 173   2        }
 174   1      
 175   1        return;
 176   1      }
 177          
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 4   

 178          /*
 179          parameter: 
 180            none
 181          return :
 182            none
 183          */
 184          unsigned char mmi_dq_ms_get_run_flag(void)
 185          {
 186   1        if ((key_last_value == KEY_INVALID) && (mmi_dq_aud_get_state() == 0) && (mmi_dq_rst_get_pin() == 0)
 187   1      #ifdef __LOCK_FP_SUPPORT__
 188   1          && (mmi_dq_fp_get_pin() != 1)
 189   1      #endif
 190   1      #ifdef __LOCK_RFID_CARD_SUPPORT__
 191   1          && rfid_last_flag == 0
 192   1      #endif
 193   1        )
 194   1          return 0;
 195   1      
 196   1        return 1;
 197   1      }
 198          
 199          /*
 200          parameter: 
 201            none
 202          return :
 203            none
 204          */
 205          void mmi_dq_ms_sys_msg_handle(void)
 206          {
 207   1        Sys_MSG_Queue_M sys_msg_que;
 208   1        if (mmi_OutQueue(&sys_msg_que))
 209   1        {
 210   2          mmi_dq_sys_sleep_timer_reset();
 211   2          switch (sys_msg_que.que_event)
 212   2          {
 213   3          case QUE_EVENT_KEY:
 214   3            mmi_ms_pwd_opt_fun(sys_msg_que.que_data);
 215   3            break;
 216   3      #ifdef __LOCK_FP_SUPPORT__
 217   3          case QUE_EVENT_FP:
 218   3            mmi_ms_fps_opt_fun(sys_msg_que.que_data);
 219   3            break;
 220   3      #endif
 221   3      #ifdef __LOCK_RFID_CARD_SUPPORT__
 222   3          case QUE_EVENT_RFID:
 223   3            mmi_ms_rfid_opt_fun(sys_msg_que.que_data);
 224   3            break;
 225   3      #endif
 226   3          case QUE_EVENT_RST:
 227   3            mmi_ms_reset_opt_fun();
 228   3            break;
 229   3          case QUE_EVENT_AUDIO_END:
 230   3      
 231   3            break;
 232   3          case QUE_EVENT_TIMER_END:
 233   3            mmi_dq_sys_delay_event_pro();
 234   3            break;
 235   3      #ifdef __LOCK_WIFI_SUPPORT__
 236   3          case QUE_EVENT_WIFI_CHECK:
 237   3            mmi_ms_wifi_opt_fun();
 238   3            break;
 239   3      #endif
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 5   

 240   3          default:
 241   3            break;
 242   3          }
 243   2        }
 244   1      }
 245          
 246          /*
 247          parameter: 
 248            none
 249          return :
 250            none
 251          */
 252          void mmi_dq_ms_set_msg_que(SYS_QUEUE_EVENT q_event, SYS_QUEUE_PRO q_pro, unsigned char q_data)
 253          {
 254   1        Sys_MSG_Queue_M que;
 255   1        que.que_event = q_event;
 256   1        que.que_pro = q_pro;
 257   1        que.que_data = q_data;
 258   1        //printf("mmi_dq_ms_set_msg_que  event : %d",q_event);
 259   1        mmi_InQueue(que);
 260   1        return;
 261   1      }
 262          
 263          /*
 264          parameter: 
 265            none
 266          return :
 267            none
 268          */
 269          void mmi_dq_ms_set_sys_state(SYS_BASE_STATUS state)
 270          {
 271   1        sys_state = state;
 272   1        return;
 273   1      }
 274          
 275          /*
 276          parameter: 
 277            none
 278          return :
 279            none
 280          */
 281          SYS_BASE_STATUS mmi_dq_ms_get_sys_state(void)
 282          {
 283   1        return sys_state;
 284   1      }
 285          
 286          /*
 287          parameter: 
 288            none
 289          return :
 290            none
 291          */
 292          void mmi_ms_pwd_init_var(void)
 293          {
 294   1        key_len = 0;
 295   1        opt_time = OPT_ONE_TIME;
 296   1        memset(input_key_1, 0xFF, sizeof(input_key_1));
 297   1        memset(input_key_2, 0xFF, sizeof(input_key_2));
 298   1      }
 299          
 300          /*
 301          parameter: 
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 6   

 302            none
 303          return :
 304            none
 305          */
 306          void mmi_ms_opt_time_init(void)
 307          {
 308   1        opt_time = OPT_ONE_TIME;
 309   1      }
 310          
 311          /*
 312          parameter: 
 313            none
 314          return :
 315            none
 316          */
 317          void mmi_ms_pwd_opt_fun(unsigned char key_val)
 318          {
 319   1        SYS_BASE_STATUS status = mmi_dq_ms_get_sys_state();
 320   1        //printf("mmi_ms_pwd_opt_fun status: 0x%x  key: %d",status,key_val);
 321   1        switch (status)
 322   1        {
 323   2        case SYS_STATUS_WAIT_FOR_ENTER_SLEEP:
 324   2          mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
 325   2          status = SYS_STATUS_IDLE;
 326   2        case SYS_STATUS_INPUT_PWD:
 327   2        case SYS_STATUS_INPUT_ADMIN_PWD:
 328   2        case SYS_STATUS_ADD_PWD:
 329   2        case SYS_STATUS_DEL_PWD:
 330   2        case SYS_STATUS_ADD_ADMIN_PWD:
 331   2        case SYS_STATUS_CHG_ADMIN_PWD:
 332   2      #ifdef __LOCK_110_SUPPORT__
 333   2        case SYS_STATUS_ADD_110_PWD:
 334   2      #endif
 335   2          if (mmi_dq_sys_door_state_check() == 1)
 336   2          {
 337   3            mmi_dq_aud_stop();
 338   3            mmi_dq_aud_play_with_id(AUD_ID_RONG_TIMES_EXCEED);
 339   3      #ifdef __LOCK_WIFI_SUPPORT__
 340   3            mmi_dq_wifi_pw_alarm();
 341   3      #endif
 342   3            return;
 343   3          }
 344   2          if (key_len == 0)
 345   2          {
 346   3            if (key_val == KEY_S)
 347   3            {
 348   4              if (SYS_STATUS_ADD_ADMIN_PWD != status)
 349   4              {
 350   5                mmi_dq_aud_play_key_tone();
 351   5                if (status == SYS_STATUS_INPUT_PWD)
 352   5                  //mmi_dq_sys_enter_sleep();
 353   5                  mmi_dq_ms_set_sys_state(SYS_STATUS_WAIT_FOR_ENTER_SLEEP);
 354   5                else if (status == SYS_STATUS_INPUT_ADMIN_PWD)
 355   5                  mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
 356   5      #ifdef __LOCK_WIFI_SUPPORT__
 357   5                else if (wifi_add_flag != 0)
 358   5                {
 359   6                  wifi_add_flag = 0;
 360   6                  mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
 361   6                }
 362   5                else
 363   5      #endif
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 7   

 364   5                  mmi_dq_sys_show_cur_menu_list();
 365   5              }
 366   4              break;
 367   4            }
 368   3            else if (key_val == KEY_H)
 369   3            {
 370   4              if (status == SYS_STATUS_INPUT_PWD)
 371   4              {
 372   5                mmi_dq_aud_play_key_tone();
 373   5      #ifdef __LOCK_BUS_SUPPORT__
 374   5                admin_check_type = 0;
 375   5      #endif
 376   5                mmi_dq_aud_play_with_id(AUD_ID_INPUT_ADMIN_PWD);
 377   5                mmi_dq_ms_set_sys_state(SYS_STATUS_INPUT_ADMIN_PWD);
 378   5              }
 379   4              break;
 380   4            }
 381   3          }
 382   2      
 383   2          // mmi_dq_aud_play_key_num(key_val);
 384   2          mmi_dq_aud_play_key_tone();
 385   2          //input pwd
 386   2          if ((key_val >= KEY_0 && key_val <= KEY_9) && key_len < KEY_INPUT_MAX_LEN)
 387   2          {
 388   3            if ((status == SYS_STATUS_INPUT_PWD) || (status == SYS_STATUS_INPUT_ADMIN_PWD))
 389   3              input_key_1[key_len++] = key_val;
 390   3            else // if((status == SYS_STATUS_ADD_PWD)||(status == SYS_STATUS_ADD_110_PWD)||(status == SYS_STATUS_AD
             -D_ADMIN_PWD))
 391   3            {
 392   4              if (opt_time == OPT_ONE_TIME)
 393   4              {
 394   5                input_key_1[key_len++] = key_val;
 395   5              }
 396   4              else if (opt_time == OPT_TWO_TIME)
 397   4              {
 398   5                input_key_2[key_len++] = key_val;
 399   5              }
 400   4            }
 401   3          }
 402   2      
 403   2          if (key_val == KEY_S)
 404   2          {
 405   3            if (opt_time == OPT_ONE_TIME)
 406   3              input_key_1[key_len--] = 0xFF;
 407   3            else if (opt_time == OPT_TWO_TIME)
 408   3              input_key_2[key_len--] = 0xFF;
 409   3      
 410   3            if (key_len == 0)
 411   3            {
 412   4              if (status == SYS_STATUS_INPUT_ADMIN_PWD)
 413   4                mmi_dq_aud_play_with_id(AUD_ID_INPUT_ADMIN_PWD);
 414   4              else if (opt_time == OPT_ONE_TIME)
 415   4              {
 416   5                if (status == SYS_STATUS_ADD_PWD || status == SYS_STATUS_ADD_110_PWD)
 417   5                  mmi_dq_aud_play_with_id(AUD_ID_INPUT_68_PWD);
 418   5                else if (status == SYS_STATUS_DEL_PWD)
 419   5                  mmi_dq_aud_play_with_id(AUD_ID_INPUT_DEL_NUM);
 420   5                else if (status == SYS_STATUS_ADD_ADMIN_PWD)
 421   5                  mmi_dq_aud_play_with_id(AUD_ID_ADD_ADMIN_PWD_FIRST);
 422   5                else if (status == SYS_STATUS_CHG_ADMIN_PWD)
 423   5                  mmi_dq_aud_play_with_id(AUD_ID_INPUT_NEW_ADMIN_PWD);
 424   5              }
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 8   

 425   4              else if (opt_time == OPT_TWO_TIME)
 426   4              {
 427   5                if (status == SYS_STATUS_ADD_PWD || status == SYS_STATUS_ADD_110_PWD)
 428   5                  mmi_dq_aud_play_with_id(AUD_ID_PWD_INPUT_AGAIN);
 429   5                else if (status == SYS_STATUS_DEL_PWD)
 430   5                  mmi_dq_aud_play_with_id(AUD_ID_INPUT_DEL_PWD_AGAIN);
 431   5                else if (status == SYS_STATUS_ADD_ADMIN_PWD)
 432   5                  mmi_dq_aud_play_with_id(AUD_ID_INPUT_ADMIN_PWD_INIT_AGAIN);
 433   5                else if (status == SYS_STATUS_CHG_ADMIN_PWD)
 434   5                  mmi_dq_aud_play_with_id(AUD_ID_INPUT_NEW_ADMIN_PWD_AGAIN);
 435   5              }
 436   4            }
 437   3          }
 438   2          else if ((key_val == KEY_H) || (key_len == PWD_INPUT_MAX_LEN))
 439   2          {
 440   3            if (key_len < PWD_INPUT_MIN_LEN)
 441   3            {
 442   4              if (status == SYS_STATUS_INPUT_PWD)
 443   4              {
 444   5                if (key_len == 2 && input_key_1[0] == KEY_0 && input_key_1[1] == KEY_0) //00 è¿œç¨‹å¼€é—¨
 445   5                  mmi_dq_sys_wifi_open();
 446   5      #ifdef __LOCK_WIFI_SUPPORT__
 447   5                else if (key_len == 1 && input_key_1[0] == KEY_5) //5 æ·»åŠ åˆ é™¤å¯†ç /æŒ‡çº¹/RFå¡
 448   5                  mmi_dq_wifi_cmd_add_del();
 449   5                else if (key_len == 1 && input_key_1[0] == KEY_6) //6 è®¾ç½®æ‹ç…§/å½•åƒå¼€å…³
 450   5                  mmi_dq_wifi_pv_switch();
 451   5                else if (key_len == 2 && input_key_1[0] == KEY_1 && input_key_1[1] == KEY_8) //18 åº”æ€¥é’¥åŒ™å¼€é—¨æ
             -ˆåŠŸ
 452   5                  mmi_dq_wifi_open_by_key();
 453   5                else if (key_len == 2 && input_key_1[0] == KEY_1 && input_key_1[1] == KEY_9) //19 é—¨æœªå…³
 454   5                  mmi_dq_wifi_close_over_time();
 455   5                else if (key_len == 2 && input_key_1[0] == KEY_2 && input_key_1[1] == KEY_0) //20 éœ‡åŠ¨æŠ¥è­¦
 456   5                  mmi_dq_wifi_via_alarm();
 457   5                else if (key_len == 2 && input_key_1[0] == KEY_2 && input_key_1[1] == KEY_5) //25 ç¡çœ 
 458   5                  mmi_dq_wifi_sleep();
 459   5                else if (key_len == 2 && input_key_1[0] == KEY_2 && input_key_1[1] == KEY_6) //26 å”¤é†’
 460   5                  mmi_dq_wifi_wakeup();
 461   5                // else if (key_len == 2 && input_key_1[0] == KEY_2 && input_key_1[1] == KEY_7) //27 æ‹ç…§
 462   5                //  mmi_dq_wifi_take_photos();
 463   5                else if (key_len == 2 && input_key_1[0] == KEY_2 && input_key_1[1] == KEY_8) //28 å½•åƒ
 464   5                  mmi_dq_wifi_take_videos();
 465   5                else if (key_len == 2 && input_key_1[0] == KEY_3 && input_key_1[1] == KEY_0) //30 æŸ¥è¯¢ç½‘ç»œçŠ¶æ€
 466   5                  mmi_dq_wifi_check_net();
 467   5                  // else if (key_len == 2 && input_key_1[0] == KEY_3 && input_key_1[1] == KEY_1) //31 Airkissé…ç½‘(a
             -dmin 8)
 468   5                  // mmi_dq_wifi_arikiss_con();
 469   5                  // else if (key_len == 2 && input_key_1[0] == KEY_3 && input_key_1[1] == KEY_2) //32 äºŒç»´ç é…ç½‘
             -(admin 9)
 470   5                  //  mmi_dq_wifi_code_con();
 471   5      #endif
 472   5      #ifdef __LOCK_BUS_SUPPORT__
 473   5                else if (key_len == 2 && input_key_1[0] == KEY_0 && input_key_1[1] == KEY_1) //01
 474   5                {
 475   6      
 476   6                  if (mmi_dq_fs_get_business_flag() == 1)
 477   6                  {
 478   7                    admin_check_type = 1;
 479   7                    mmi_dq_aud_play_with_id(AUD_ID_INPUT_ADMIN_PWD);
 480   7                    mmi_dq_ms_set_sys_state(SYS_STATUS_INPUT_ADMIN_PWD);
 481   7                  }
 482   6                  else
 483   6                  {
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 9   

 484   7                    mmi_dq_fs_set_business_flag(1);
 485   7                    mmi_dq_aud_play_with_id(AUD_ID_OUT_OPEN);
 486   7                    mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
 487   7                  }
 488   6                }
 489   5      #endif
 490   5                else
 491   5                {
 492   6                  mmi_dq_sys_door_open_fail(SYS_OPEN_BY_PASSWORD);
 493   6                }
 494   5                key_len = 0;
 495   5                memset(input_key_1, 0xFF, sizeof(input_key_1));
 496   5              }
 497   4              else
 498   4              {
 499   5                mmi_dq_aud_play_with_id(AUD_ID_PWD_68_LEN);
 500   5                key_len = 0;
 501   5                if (opt_time == OPT_ONE_TIME)
 502   5                  memset(input_key_1, 0xFF, sizeof(input_key_1));
 503   5                else if (opt_time == OPT_TWO_TIME)
 504   5                  memset(input_key_2, 0xFF, sizeof(input_key_2));
 505   5              }
 506   4            }
 507   3            else
 508   3            {
 509   4              if (status == SYS_STATUS_INPUT_PWD)
 510   4              {
 511   5                //if(mmi_dq_fs_check_input_pwd(input_key_1,key_len,FDS_USE_TYPE_ALL) == 0xFF)
 512   5                unsigned char ret = 0;
 513   5                ret = mmi_dq_fs_check_input_pwd_for_open(input_key_1, key_len);
 514   5                //printf("check input ret: %d",(unsigned int)ret);
 515   5                if (ret == 0xFF)
 516   5                  mmi_dq_sys_door_open_fail(SYS_OPEN_BY_PASSWORD);
 517   5      #ifdef __LOCK_BUS_SUPPORT__
 518   5                else if (ret == 0xFE && mmi_dq_fs_get_business_flag() == 1)
 519   5                {
 520   6                  mmi_dq_fs_set_business_flag(0);
 521   6                  mmi_dq_aud_play_with_id(AUD_ID_OUT_CLOSED);
 522   6                  mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
 523   6                }
 524   5      #endif
 525   5      #ifdef __LOCK_110_SUPPORT__
 526   5                else if (ret == 1)
 527   5                  mmi_dq_sys_door_open(SYS_OPEN_BY_110_PASSWORD);
 528   5      #endif
 529   5                else
 530   5                  mmi_dq_sys_door_open(SYS_OPEN_BY_PASSWORD);
 531   5                key_len = 0;
 532   5                memset(input_key_1, 0xFF, sizeof(input_key_1));
 533   5              }
 534   4              else if (status == SYS_STATUS_INPUT_ADMIN_PWD)
 535   4              {
 536   5                if (mmi_dq_fs_check_input_pwd(input_key_1, key_len, FDS_USE_TYPE_ADMIN) == 0xFF)
 537   5                  mmi_dq_aud_play_with_id(AUD_ID_PWD_WRONG_TRY);
 538   5                else
 539   5                {
 540   6      #ifdef __LOCK_BUS_SUPPORT__
 541   6                  if (admin_check_type == 1)
 542   6                  {
 543   7                    mmi_dq_fs_set_business_flag(0);
 544   7                    mmi_dq_aud_play_with_id(AUD_ID_OUT_CLOSED);
 545   7                    mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 10  

 546   7                  }
 547   6                  else
 548   6      #endif
 549   6                  {
 550   7                    mmi_dq_sys_set_menu_father_id(STR_ID_SYSTEM);
 551   7                    mmi_dq_sys_show_cur_menu_list();
 552   7                  }
 553   6                }
 554   5                key_len = 0;
 555   5                memset(input_key_1, 0xFF, sizeof(input_key_1));
 556   5              }
 557   4              else // if((status == SYS_STATUS_ADD_PWD)||(status == SYS_STATUS_DEL_PWD)||(status == SYS_STATUS_ADD_A
             -DMIN_PWD)||(status == SYS_STATUS_CHG_ADMIN_PWD)||(status == SYS_STATUS_ADD_110_PWD))
 558   4              {
 559   5                if (opt_time == OPT_ONE_TIME)
 560   5                {
 561   6                  if (status == SYS_STATUS_ADD_PWD || status == SYS_STATUS_ADD_110_PWD)
 562   6                    mmi_dq_aud_play_with_id(AUD_ID_PWD_INPUT_AGAIN);
 563   6                  else if (status == SYS_STATUS_DEL_PWD)
 564   6                    mmi_dq_aud_play_with_id(AUD_ID_INPUT_DEL_PWD_AGAIN);
 565   6                  else if (status == SYS_STATUS_ADD_ADMIN_PWD)
 566   6                    mmi_dq_aud_play_with_id(AUD_ID_INPUT_ADMIN_PWD_INIT_AGAIN);
 567   6                  else if (status == SYS_STATUS_CHG_ADMIN_PWD)
 568   6                    mmi_dq_aud_play_with_id(AUD_ID_INPUT_NEW_ADMIN_PWD_AGAIN);
 569   6      
 570   6                  opt_time = OPT_TWO_TIME;
 571   6                  key_len = 0;
 572   6                  memset(input_key_2, 0xFF, sizeof(input_key_2));
 573   6                }
 574   5                else if (opt_time == OPT_TWO_TIME)
 575   5                {
 576   6                  if (0 == memcmp(input_key_1, input_key_2, PWD_INPUT_MAX_LEN))
 577   6                  {
 578   7                    if (status == SYS_STATUS_DEL_PWD)
 579   7                    {
 580   8                      unsigned char del_index = mmi_dq_fs_check_input_pwd(input_key_1, key_len, FDS_USE_TYPE_USER);
 581   8                      if (del_index == 0xFF)
 582   8                        mmi_dq_aud_play_with_id(AUD_ID_PWD_NOT_EXIST);
 583   8                      else
 584   8                      {
 585   9                        if (mmi_dq_fs_del_pwd(del_index, FDS_USE_TYPE_USER) == RET_SUCESS)
 586   9                        {
 587  10                          get_index = del_index;
 588  10                          mmi_dq_aud_play_with_id(AUD_ID_DEL_PWD_SUCESS);
 589  10      #ifdef __LOCK_WIFI_SUPPORT__
 590  10                          mmi_dq_wifi_del_password(get_index);
 591  10      #endif
 592  10                          // printfV("get_index", (int)get_index);
 593  10                        }
 594   9                        else
 595   9                          mmi_dq_aud_play_with_id(AUD_ID_DEL_FAIL);
 596   9                        mmi_dq_sys_del_pwd_con();
 597   9                      }
 598   8                    }
 599   7                    else if (mmi_dq_fs_check_input_pwd(input_key_1, key_len, FDS_USE_TYPE_ALL) != 0xFF)
 600   7                      mmi_dq_aud_play_with_id(AUD_ID_PWD_EXIST);
 601   7                    else
 602   7                    {
 603   8                      if (status == SYS_STATUS_ADD_PWD)
 604   8                      {
 605   9                        if (mmi_dq_fs_set_pwd(input_key_1, key_len, FDS_USE_TYPE_USER) == RET_FAIL)
 606   9                          mmi_dq_aud_play_with_id(AUD_ID_ADD_FAIL);
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 11  

 607   9                        else
 608   9                        {
 609  10                          mmi_dq_aud_play_with_id(AUD_ID_ADD_PWD_SUCESS);
 610  10      #ifdef __LOCK_WIFI_SUPPORT__
 611  10                          mmi_dq_wifi_add_password(get_index);
 612  10      #endif
 613  10                          // printfV("get_index", (int)get_index);
 614  10                        }
 615   9      #ifdef __LOCK_WIFI_SUPPORT__
 616   9                        if (wifi_add_flag != 0)
 617   9                        {
 618  10                          wifi_add_flag = 0;
 619  10                          mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
 620  10                        }
 621   9                        else
 622   9      #endif
 623   9                          mmi_dq_sys_add_pwd_con();
 624   9                      }
 625   8                      else if (status == SYS_STATUS_ADD_ADMIN_PWD)
 626   8                      {
 627   9                        if (mmi_dq_fs_set_pwd(input_key_1, key_len, FDS_USE_TYPE_ADMIN) == RET_FAIL)
 628   9                          mmi_dq_aud_play_with_id(AUD_ID_ADD_FAIL);
 629   9                        else
 630   9                        {
 631  10                          mmi_dq_aud_play_with_id(AUD_ID_ADD_ADMIN_PWD_INIT_SUCESS);
 632  10      #ifdef __LOCK_WIFI_SUPPORT__
 633  10                          mmi_dq_wifi_add_password(get_index);
 634  10      #endif
 635  10                          // printfV("get_index", (int)get_index);
 636  10                        }
 637   9      #ifdef __LOCK_FP_SUPPORT__
 638   9                        mmi_dq_sys_chg_admin_fp_No1();
 639   9      #else
                                if (0 == mmi_dq_fs_get_admin_status())
                                  mmi_dq_sys_lock_add_admin_suc();
                                else
                                  mmi_dq_sys_show_cur_menu_list();
              #endif
 645   9                      }
 646   8                      else if (status == SYS_STATUS_CHG_ADMIN_PWD)
 647   8                      {
 648   9                        if (mmi_dq_fs_set_pwd(input_key_1, key_len, FDS_USE_TYPE_ADMIN) == RET_FAIL)
 649   9                          mmi_dq_aud_play_with_id(AUD_ID_ADD_FAIL);
 650   9                        else
 651   9                        {
 652  10                          mmi_dq_aud_play_with_id(AUD_ID_CHG_ADMIN_PWD_SUCESS);
 653  10      #ifdef __LOCK_WIFI_SUPPORT__
 654  10                          mmi_dq_wifi_add_password(get_index);
 655  10      #endif
 656  10                          // printfV("get_index", (int)get_index);
 657  10                        }
 658   9                        mmi_dq_sys_show_cur_menu_list();
 659   9                      }
 660   8      #ifdef __LOCK_110_SUPPORT__
 661   8                      else if (status == SYS_STATUS_ADD_110_PWD)
 662   8                      {
 663   9                        if (mmi_dq_fs_set_pwd(input_key_1, key_len, FDS_USE_TYPE_110) == RET_FAIL)
 664   9                          mmi_dq_aud_play_with_id(AUD_ID_ADD_FAIL);
 665   9                        else
 666   9                        {
 667  10      #ifdef __LOCK_WIFI_SUPPORT__
 668  10                          mmi_dq_wifi_set_110();
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 12  

 669  10      #endif
 670  10                          mmi_dq_aud_play_with_id(AUD_ID_ADD_PWD_SUCESS);
 671  10      #ifdef __LOCK_WIFI_SUPPORT__
 672  10                          mmi_dq_wifi_add_password(get_index);
 673  10      #endif
 674  10                          // printfV("get_index", (int)get_index);
 675  10                        }
 676   9                        mmi_dq_sys_show_cur_menu_list();
 677   9                      }
 678   8      #endif
 679   8                    }
 680   7                  }
 681   6                  else
 682   6                  {
 683   7                    mmi_dq_aud_play_with_id(AUD_ID_PWD_NOT_SAME_RETRY);
 684   7                  }
 685   6                  mmi_ms_pwd_init_var();
 686   6                }
 687   5              }
 688   4            }
 689   3            return;
 690   3          }
 691   2          break;
 692   2      #ifdef __LOCK_FP_SUPPORT__
 693   2        case SYS_STATUS_ADD_FP:
 694   2        case SYS_STATUS_DEL_FP:
 695   2      #ifdef __LOCK_110_SUPPORT__
 696   2        case SYS_STATUS_ADD_110_FP:
 697   2        case SYS_STATUS_DEL_110_FP:
 698   2      #endif
 699   2      #endif
 700   2      #ifdef __LOCK_RFID_CARD_SUPPORT__
 701   2        case SYS_STATUS_ADD_RFID:
 702   2        case SYS_STATUS_DEL_RFID:
 703   2      #endif
 704   2          if (key_val == KEY_S)
 705   2          {
 706   3            mmi_dq_aud_play_key_tone();
 707   3      #ifdef __LOCK_WIFI_SUPPORT__
 708   3            if (wifi_add_flag != 0)
 709   3            {
 710   4              wifi_add_flag = 0;
 711   4              mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
 712   4            }
 713   3            else
 714   3      #endif
 715   3              mmi_dq_sys_show_cur_menu_list();
 716   3          }
 717   2          break;
 718   2      #ifdef __LOCK_FP_SUPPORT__
 719   2        case SYS_STATUS_ADD_ADMIN_FP1:
 720   2        case SYS_STATUS_ADD_ADMIN_FP2:
 721   2          if (key_val == KEY_S)
 722   2          {
 723   3            mmi_dq_aud_play_key_tone();
 724   3            if (0 == mmi_dq_fs_get_admin_status())
 725   3              mmi_dq_sys_lock_add_admin_suc();
 726   3            else
 727   3              mmi_dq_sys_show_cur_menu_list();
 728   3          }
 729   2          break;
 730   2      #endif
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 13  

 731   2        case SYS_STATUS_CLR_PWD:
 732   2        case SYS_STATUS_ADD_PWD_CON:
 733   2        case SYS_STATUS_DEL_PWD_CON:
 734   2      #ifdef __LOCK_FP_SUPPORT__
 735   2        case SYS_STATUS_CLR_FP:
 736   2        case SYS_STATUS_ADD_FP_CON:
 737   2        case SYS_STATUS_DEL_FP_CON:
 738   2      #endif
 739   2      #ifdef __LOCK_RFID_CARD_SUPPORT__
 740   2        case SYS_STATUS_CLR_RFID:
 741   2        case SYS_STATUS_ADD_RFID_CON:
 742   2        case SYS_STATUS_DEL_RFID_CON:
 743   2      #endif
 744   2        case SYS_STATUS_RESTORE_LOCK_CON:
 745   2          if (key_val == KEY_H)
 746   2          {
 747   3            mmi_dq_aud_play_key_tone();
 748   3            switch (status)
 749   3            {
 750   4            case SYS_STATUS_CLR_PWD:
 751   4              if (RET_SUCESS == mmi_dq_fs_clr_pwd())
 752   4              {
 753   5                mmi_dq_aud_play_with_id(AUD_ID_CLR_PWD_SUCESS);
 754   5      #ifdef __LOCK_WIFI_SUPPORT__
 755   5                mmi_dq_wifi_clr_pwd_suc();
 756   5      #endif
 757   5              }
 758   4              else
 759   4                mmi_dq_aud_play_with_id(AUD_ID_CLR_PWD_FAIL);
 760   4              mmi_dq_sys_show_cur_menu_list();
 761   4              break;
 762   4      #ifdef __LOCK_FP_SUPPORT__
 763   4            case SYS_STATUS_CLR_FP:
 764   4              if (RET_SUCESS == mmi_dq_fs_clr_fp())
 765   4              {
 766   5                mmi_dq_aud_play_with_id(AUD_ID_CLR_FP_SUCESS);
 767   5      #ifdef __LOCK_WIFI_SUPPORT__
 768   5                mmi_dq_wifi_clr_fps_suc();
 769   5      #endif
 770   5              }
 771   4              else
 772   4                mmi_dq_aud_play_with_id(AUD_ID_CLR_FP_FAIL);
 773   4              mmi_dq_sys_show_cur_menu_list();
 774   4              break;
 775   4      #endif
 776   4      #ifdef __LOCK_RFID_CARD_SUPPORT__
 777   4            case SYS_STATUS_CLR_RFID:
 778   4              if (RET_SUCESS == mmi_dq_fs_clr_rfid())
 779   4              {
 780   5                mmi_dq_aud_play_with_id(AUD_ID_CLR_RFCARD_SUCESS);
 781   5      #ifdef __LOCK_WIFI_SUPPORT__
 782   5                mmi_dq_wifi_clr_rfid_suc();
 783   5      #endif
 784   5              }
 785   4              else
 786   4                mmi_dq_aud_play_with_id(AUD_ID_CLR_RFCARD_FAIL);
 787   4              mmi_dq_sys_show_cur_menu_list();
 788   4              break;
 789   4      #endif
 790   4            case SYS_STATUS_ADD_PWD_CON:
 791   4              mmi_dq_sys_add_pwd();
 792   4              break;
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 14  

 793   4            case SYS_STATUS_DEL_PWD_CON:
 794   4              mmi_dq_sys_del_pwd();
 795   4              break;
 796   4      #ifdef __LOCK_FP_SUPPORT__
 797   4            case SYS_STATUS_ADD_FP_CON:
 798   4              mmi_dq_sys_add_fp();
 799   4              break;
 800   4            case SYS_STATUS_DEL_FP_CON:
 801   4              mmi_dq_sys_del_fp();
 802   4              break;
 803   4      #endif
 804   4      #ifdef __LOCK_RFID_CARD_SUPPORT__
 805   4            case SYS_STATUS_ADD_RFID_CON:
 806   4              mmi_dq_sys_add_rf();
 807   4              break;
 808   4            case SYS_STATUS_DEL_RFID_CON:
 809   4              mmi_dq_sys_del_rf();
 810   4              break;
 811   4      #endif
 812   4            case SYS_STATUS_RESTORE_LOCK_CON:
 813   4              mmi_dq_sys_restore_lock();
 814   4              break;
 815   4            }
 816   3          }
 817   2          else if (key_val == KEY_S)
 818   2          {
 819   3            mmi_dq_aud_play_key_tone();
 820   3            mmi_dq_sys_show_cur_menu_list();
 821   3          }
 822   2          break;
 823   2        case SYS_STATUS_SYS_MENU:
 824   2          if (key_val == KEY_S)
 825   2          {
 826   3            mmi_dq_aud_play_key_tone();
 827   3            mmi_dq_sys_get_pre_menu_list();
 828   3          }
 829   2          else if (key_val != KEY_0 && key_val <= mmi_dq_sys_get_menu_count())
 830   2          {
 831   3            mmi_dq_aud_play_key_tone();
 832   3            mmi_dq_sys_exe_menu_fun(key_val - 1);
 833   3          }
 834   2          break;
 835   2      #ifdef __FACTORY_TEST_SUPPORT__
 836   2        case SYS_STATUS_FM_MODE:
 837   2        {
 838   3          unsigned char str = mmi_dq_factory_mode_get_test_project();
 839   3          if (str == STR_ID_KEY)
 840   3          {
 841   4            // mmi_dq_aud_play_key_num(key_val);
 842   4            mmi_dq_aud_play_key_tone();
 843   4            mmi_dq_factory_mode_key_test(key_val);
 844   4          }
 845   3          else if (str == STR_ID_MOTO)
 846   3          {
 847   4            if (key_val == KEY_S)
 848   4            {
 849   5              mmi_dq_aud_play_key_tone();
 850   5      #ifdef __LOCK_MOTOR_SUPPORT__
 851   5              mmi_dq_factory_mode_motor_test_back();
 852   5      #endif
 853   5              if (mmi_dq_fs_get_factory_flag() != 0)
 854   5                mmi_dq_factory_mode_test_stop();
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 15  

 855   5              else
 856   5              {
 857   6      #ifdef __LOCK_MOTOR_SUPPORT__
 858   6                delay_ms(600);
 859   6                mmi_dq_factory_mode_motor_test();
 860   6      #endif
 861   6              }
 862   5            }
 863   4            else if (key_val == KEY_H)
 864   4            {
 865   5              mmi_dq_aud_play_key_tone();
 866   5      #ifdef __LOCK_MOTOR_SUPPORT__
 867   5              mmi_dq_factory_mode_motor_test_back();
 868   5      #endif
 869   5              mmi_dq_factory_mode_test_item_result(STR_ID_MOTO, 1);
 870   5            }
 871   4          }
 872   3          else if (mmi_dq_fs_get_factory_flag() != 0)
 873   3          {
 874   4            mmi_dq_aud_play_key_tone();
 875   4            mmi_dq_factory_mode_test_stop();
 876   4          }
 877   3        }
 878   2        break;
 879   2      #endif
 880   2      #ifdef __LOCK_WIFI_SUPPORT__
 881   2        case SYS_STATUS_WIFI_MODE:
 882   2          //if(key_val == KEY_S)
 883   2          //{
 884   2          mmi_dq_aud_stop();
 885   2          mmi_dq_aud_play_with_id(AUD_ID_WIFI_CONNECTING);
 886   2          //  mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
 887   2          //}
 888   2          break;
 889   2      #endif
 890   2        case SYS_STATUS_LOW_POWER:
 891   2          mmi_dq_aud_stop();
 892   2          mmi_dq_aud_play_with_id(AUD_ID_LOW_BATTERY);
 893   2      #ifdef __LOCK_WIFI_SUPPORT__
 894   2          mmi_dq_wifi_lowpower_alarm();
 895   2      #endif
 896   2          break;
 897   2        default:
 898   2          break;
 899   2        }
 900   1        return;
 901   1      }
 902          
 903          #ifdef __LOCK_FP_SUPPORT__
 904          /*
 905          parameter: 
 906            none
 907          return :
 908            none
 909          */
 910          void mmi_ms_fps_opt_fun(unsigned char fps_val)
 911          {
 912   1        RET_VAL retval = 0;
 913   1        unsigned short index = 0;
 914   1        SYS_BASE_STATUS status = mmi_dq_ms_get_sys_state();
 915   1        if (status == SYS_STATUS_LOW_POWER)
 916   1        {
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 16  

 917   2          mmi_dq_aud_stop();
 918   2          mmi_dq_aud_play_with_id(AUD_ID_LOW_BATTERY);
 919   2      #ifdef __LOCK_WIFI_SUPPORT__
 920   2          mmi_dq_wifi_lowpower_alarm();
 921   2      #endif
 922   2          return;
 923   2        }
 924   1        else if (status == SYS_STATUS_WAIT_FOR_ENTER_SLEEP)
 925   1          mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
 926   1      
 927   1        if ((status != SYS_STATUS_INPUT_FP && status != SYS_STATUS_ADD_FP && status != SYS_STATUS_DEL_FP && statu
             -s != SYS_STATUS_ADD_ADMIN_FP1 && status != SYS_STATUS_ADD_ADMIN_FP2 && status != SYS_STATUS_ADD_110_FP && status != SYS_
             -STATUS_DEL_110_FP)
 928   1      #ifdef __FACTORY_TEST_SUPPORT__
 929   1          || (status == SYS_STATUS_FM_MODE && STR_ID_FINGERPRINT != mmi_dq_factory_mode_get_test_project())
 930   1      #endif
 931   1        )
 932   1          return;
 933   1      
 934   1      #ifdef __LOCK_AUDIO_SUPPORT__
 935   1        mmi_dq_aud_stop();
 936   1      #endif
 937   1        if (mmi_dq_sys_door_state_check() == 1)
 938   1        {
 939   2          mmi_dq_aud_stop();
 940   2          mmi_dq_aud_play_with_id(AUD_ID_RONG_TIMES_EXCEED);
 941   2      #ifdef __LOCK_WIFI_SUPPORT__
 942   2          mmi_dq_wifi_fp_alarm();
 943   2      #endif
 944   2          return;
 945   2        }
 946   1      
 947   1        retval = mmi_dq_fp_get_image();
 948   1      
 949   1        if (retval == 0)
 950   1        {
 951   2          // printfS("mmi_dq_fp_get_image", "ok");
 952   2          // if (opt_time != 0)
 953   2          //  retval = mmi_dq_fp_gen_char(0);
 954   2          // if (retval == 0)
 955   2          retval = mmi_dq_fp_gen_char(opt_time);
 956   2          if (retval == 0)
 957   2          {
 958   3            // printfS("mmi_dq_fp_gen_char", "ok");
 959   3            retval = mmi_dq_fp_high_speed_search(opt_time, &index);
 960   3            if (retval == 0)
 961   3            {
 962   4              // printfS("mmi_dq_fp_high_speed_search", "ok");
 963   4              if (status == SYS_STATUS_INPUT_FP)
 964   4              {
 965   5                retval = mmi_dq_fs_check_fp((unsigned char)index, FDS_USE_TYPE_ALL);
 966   5                if (retval == RET_SUCESS)
 967   5                {
 968   6                  get_index = index;
 969   6                  mmi_dq_fp_light(FP_GREEN);
 970   6      #ifdef __LOCK_110_SUPPORT__
 971   6                  if (mmi_dq_fs_check_fp((unsigned char)index, FDS_USE_TYPE_110) == RET_SUCESS)
 972   6                  {
 973   7                    mmi_dq_sys_door_open(SYS_OPEN_BY_110_FP);
 974   7                  }
 975   6                  else
 976   6      #endif
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 17  

 977   6                    mmi_dq_sys_door_open(SYS_OPEN_BY_FP);
 978   6                }
 979   5                else
 980   5                {
 981   6                  mmi_dq_fp_light(FP_RED);
 982   6                  mmi_dq_sys_door_open_fail(SYS_OPEN_BY_FP);
 983   6                }
 984   5              }
 985   4              else if (status == SYS_STATUS_ADD_FP || status == SYS_STATUS_ADD_ADMIN_FP1 || status == SYS_STATUS_ADD
             -_ADMIN_FP2 || status == SYS_STATUS_ADD_110_FP || status == SYS_STATUS_FM_MODE)
 986   4              {
 987   5                mmi_dq_fp_light(FP_RED);
 988   5                mmi_dq_aud_play_with_id(AUD_ID_FP_EXIST);
 989   5              }
 990   4              else if (status == SYS_STATUS_DEL_FP || status == SYS_STATUS_DEL_110_FP)
 991   4              {
 992   5      #ifdef __LOCK_110_SUPPORT__
 993   5                if (status == SYS_STATUS_DEL_FP)
 994   5                  retval = mmi_dq_fs_check_fp((unsigned char)index, FDS_USE_TYPE_USER);
 995   5                else if (status == SYS_STATUS_DEL_110_FP)
 996   5                  retval = mmi_dq_fs_check_fp((unsigned char)index, FDS_USE_TYPE_110);
 997   5      #else
                        retval = mmi_dq_fs_check_fp((unsigned char)index, FDS_USE_TYPE_USER);
              #endif
1000   5                if (retval == RET_SUCESS)
1001   5                {
1002   6                  static unsigned char del_num = 0;
1003   6                  if (opt_time == OPT_ONE_TIME)
1004   6                  {
1005   7                    opt_time = OPT_TWO_TIME;
1006   7                    del_num = index;
1007   7                    mmi_dq_fp_light(FP_GREEN);
1008   7                    mmi_dq_aud_play_with_id(AUD_ID_PRESS_DEL_FP_AGAIN);
1009   7                  }
1010   6                  else
1011   6                  {
1012   7                    //retval = mmi_dq_fp_match();
1013   7                    if (del_num == index)
1014   7                      retval = 0;
1015   7                    else
1016   7                      retval = 255;
1017   7                    if (retval == 0) //|| retval == 255)
1018   7                    {
1019   8      #ifdef __LOCK_110_SUPPORT__
1020   8                      if (status == SYS_STATUS_DEL_FP)
1021   8                        retval = mmi_dq_fs_del_fp((unsigned char)index, FDS_USE_TYPE_USER);
1022   8                      else if (status == SYS_STATUS_DEL_110_FP)
1023   8                        retval = mmi_dq_fs_del_fp((unsigned char)index, FDS_USE_TYPE_110);
1024   8      #else
                              retval = mmi_dq_fs_del_fp((unsigned char)index, FDS_USE_TYPE_USER);
              #endif
1027   8                      if (retval == RET_SUCESS)
1028   8                      {
1029   9                        retval = mmi_dq_fp_delete(index);
1030   9                      }
1031   8                      if (retval == 0)
1032   8                      {
1033   9                        mmi_dq_fp_light(FP_GREEN);
1034   9                        mmi_dq_aud_play_with_id(AUD_ID_DEL_FP_SUCESS);
1035   9      #ifdef __LOCK_WIFI_SUPPORT__
1036   9                        mmi_dq_wifi_del_fp(index);
1037   9      #endif
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 18  

1038   9                      }
1039   8                      else
1040   8                      {
1041   9                        mmi_dq_fp_light(FP_RED);
1042   9                        mmi_dq_aud_play_with_id(AUD_ID_DEL_FAIL);
1043   9                      }
1044   8      #ifdef __LOCK_110_SUPPORT__
1045   8                      if (status == SYS_STATUS_DEL_FP)
1046   8                        mmi_dq_sys_del_fp_con();
1047   8                      else if (status == SYS_STATUS_DEL_110_FP)
1048   8                        mmi_dq_sys_show_cur_menu_list();
1049   8      #else
                              mmi_dq_sys_del_fp_con();
              #endif
1052   8                    }
1053   7                    else
1054   7                    {
1055   8                      mmi_dq_fp_light(FP_RED);
1056   8                      mmi_dq_aud_play_with_id(AUD_ID_FP_TWICE_NOT_SAME_RETRY);
1057   8                    }
1058   7                    opt_time = OPT_ONE_TIME;
1059   7                  }
1060   6                }
1061   5                else
1062   5                {
1063   6                  mmi_dq_fp_light(FP_RED);
1064   6                  mmi_dq_aud_play_with_id(AUD_ID_FP_NOT_EXIST);
1065   6                }
1066   5              }
1067   4            }
1068   3            else
1069   3            {
1070   4              // printfS("mmi_dq_fp_high_speed_search", "error");
1071   4              if (status == SYS_STATUS_INPUT_FP)
1072   4              {
1073   5                mmi_dq_fp_light(FP_RED);
1074   5                //mmi_dq_aud_play_with_id(AUD_ID_FP_WRONG_TRY);
1075   5                mmi_dq_sys_door_open_fail(SYS_OPEN_BY_FP);
1076   5              }
1077   4              else if (status == SYS_STATUS_ADD_FP || status == SYS_STATUS_ADD_ADMIN_FP1 || status == SYS_STATUS_ADD
             -_ADMIN_FP2 || status == SYS_STATUS_ADD_110_FP || status == SYS_STATUS_FM_MODE)
1078   4              {
1079   5                if (opt_time == FPS_MAX_INPUT_TIME)
1080   5                {
1081   6                  retval = mmi_dq_fp_reg_module();
1082   6                  if (retval == 0)
1083   6                  {
1084   7                    // printfS("mmi_dq_fp_reg_module", "ok");
1085   7                    if (status == SYS_STATUS_ADD_FP || status == SYS_STATUS_ADD_110_FP || status == SYS_STATUS_FM_MODE)
1086   7                    {
1087   8      #ifdef __LOCK_110_SUPPORT__
1088   8                      if (status == SYS_STATUS_ADD_110_FP)
1089   8                        index = mmi_dq_fs_get_fp_110_unuse_index();
1090   8                      else
1091   8      #endif
1092   8                        index = mmi_dq_fs_get_fp_unuse_index();
1093   8                      if (index == 0xFF)
1094   8                      {
1095   9                        // printfS("mmi_dq_fs_get_fp_unuse_index", "error");
1096   9                        mmi_dq_fp_light(FP_RED);
1097   9                        mmi_dq_aud_play_with_id(AUD_ID_FP_FULL);
1098   9                        mmi_dq_sys_show_cur_menu_list();
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 19  

1099   9                      }
1100   8                      else
1101   8                      {
1102   9                        // printfS("mmi_dq_fs_get_fp_unuse_index", "ok");
1103   9                        // printfV("index", (int)index);
1104   9                        retval = mmi_dq_fp_store_char(0, index);
1105   9                        if (status == SYS_STATUS_ADD_FP)
1106   9                        {
1107  10                          if (retval == 0)
1108  10                          {
1109  11                            // printfS("mmi_dq_fp_store_char", "ok");
1110  11                            retval = mmi_dq_fs_set_fp((unsigned char)index, FDS_USE_TYPE_USER);
1111  11                            if (retval != 0)
1112  11                              mmi_dq_fp_delete(index);
1113  11                          }
1114  10                          if (retval == 0)
1115  10                          {
1116  11                            // printfS("mmi_dq_fs_set_fp", "ok");
1117  11                            mmi_dq_fp_light(FP_GREEN);
1118  11                            mmi_dq_aud_play_with_id(AUD_ID_ADD_FP_SUCESS);
1119  11      #ifdef __LOCK_WIFI_SUPPORT__
1120  11                            mmi_dq_wifi_add_fp(index);
1121  11      #endif
1122  11                          }
1123  10                          else
1124  10                          {
1125  11                            // printfS("mmi_dq_fp_store_char", "error");
1126  11                            mmi_dq_fp_light(FP_RED);
1127  11                            mmi_dq_aud_play_with_id(AUD_ID_ADD_FAIL);
1128  11                          }
1129  10      #ifdef __LOCK_WIFI_SUPPORT__
1130  10                          if (wifi_add_flag != 0)
1131  10                          {
1132  11                            wifi_add_flag = 0;
1133  11                            mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
1134  11                          }
1135  10                          else
1136  10      #endif
1137  10                            mmi_dq_sys_add_fp_con();
1138  10                        }
1139   9      #ifdef __LOCK_110_SUPPORT__
1140   9                        else if (status == SYS_STATUS_ADD_110_FP)
1141   9                        {
1142  10                          if (retval == 0)
1143  10                          {
1144  11                            retval = mmi_dq_fs_set_fp((unsigned char)index, FDS_USE_TYPE_110);
1145  11                            if (retval != 0)
1146  11                              mmi_dq_fp_delete(index);
1147  11                          }
1148  10                          if (retval == 0)
1149  10                          {
1150  11                            mmi_dq_fp_light(FP_GREEN);
1151  11                            mmi_dq_aud_play_with_id(AUD_ID_ADD_FP_SUCESS);
1152  11      #ifdef __LOCK_WIFI_SUPPORT__
1153  11                            mmi_dq_wifi_set_110();
1154  11                            mmi_dq_wifi_add_fp(index);
1155  11      #endif
1156  11                          }
1157  10                          else
1158  10                          {
1159  11                            mmi_dq_fp_light(FP_RED);
1160  11                            mmi_dq_aud_play_with_id(AUD_ID_ADD_FAIL);
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 20  

1161  11                          }
1162  10                          mmi_dq_sys_show_cur_menu_list();
1163  10                        }
1164   9      #endif
1165   9      #ifdef __FACTORY_TEST_SUPPORT__
1166   9                        else
1167   9                        {
1168  10                          if (retval == 0)
1169  10                          {
1170  11                            retval = mmi_dq_fp_delete(index);
1171  11                          }
1172  10                          if (retval == 0)
1173  10                          {
1174  11                            mmi_dq_fp_light(FP_GREEN);
1175  11                            mmi_dq_factory_mode_test_item_result(STR_ID_FINGERPRINT, 1);
1176  11                          }
1177  10                          else
1178  10                          {
1179  11                            mmi_dq_fp_light(FP_RED);
1180  11                            mmi_dq_factory_mode_test_item_result(STR_ID_FINGERPRINT, 0);
1181  11                          }
1182  10                        }
1183   9      #endif
1184   9                      }
1185   8                    }
1186   7                    else
1187   7                    {
1188   8                      if (status == SYS_STATUS_ADD_ADMIN_FP1)
1189   8                        index = 0;
1190   8                      else if (status == SYS_STATUS_ADD_ADMIN_FP2)
1191   8                        index = 1;
1192   8                      retval = mmi_dq_fp_delete(index);
1193   8                      if (retval == 0)
1194   8                        retval = mmi_dq_fp_store_char(0, index);
1195   8                      if (retval == 0)
1196   8                        retval = mmi_dq_fs_set_fp((unsigned char)index, FDS_USE_TYPE_ADMIN);
1197   8                      if (retval == 0)
1198   8                      {
1199   9                        mmi_dq_fp_light(FP_GREEN);
1200   9                        mmi_dq_aud_play_with_id(AUD_ID_ADD_FP_SUCESS);
1201   9      #ifdef __LOCK_WIFI_SUPPORT__
1202   9                        mmi_dq_wifi_add_fp(index);
1203   9      #endif
1204   9                      }
1205   8                      else
1206   8                      {
1207   9                        mmi_dq_fp_light(FP_RED);
1208   9                        mmi_dq_aud_play_with_id(AUD_ID_ADD_FAIL);
1209   9                      }
1210   8                      if (0 == mmi_dq_fs_get_admin_status())
1211   8                      {
1212   9                        if (status == SYS_STATUS_ADD_ADMIN_FP1)
1213   9                          mmi_dq_sys_chg_admin_fp_No2();
1214   9                        else
1215   9                          mmi_dq_sys_lock_add_admin_suc();
1216   9                      }
1217   8                      else
1218   8                        mmi_dq_sys_show_cur_menu_list();
1219   8                    }
1220   7                  }
1221   6                  else
1222   6                  {
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 21  

1223   7                    mmi_dq_fp_light(FP_RED);
1224   7                    mmi_dq_aud_play_with_id(AUD_ID_ADD_FAIL_RETRY);
1225   7                  }
1226   6                  opt_time = OPT_ONE_TIME;
1227   6                }
1228   5                else
1229   5                {
1230   6                  opt_time++;
1231   6                  mmi_dq_fp_light(FP_GREEN);
1232   6                  mmi_dq_aud_play_with_id(AUD_ID_PRESS_FP_AGAIN);
1233   6                }
1234   5              }
1235   4              else if (status == SYS_STATUS_DEL_FP)
1236   4              {
1237   5                mmi_dq_fp_light(FP_RED);
1238   5                mmi_dq_aud_play_with_id(AUD_ID_FP_NOT_EXIST);
1239   5              }
1240   4            }
1241   3            return;
1242   3          }
1243   2        }
1244   1        // printfS("mmi_dq_fp_get_image", "error");
1245   1      
1246   1        mmi_dq_fp_light(FP_RED);
1247   1        mmi_dq_aud_play_with_id(AUD_ID_PRESS_FP_AGAIN);
1248   1        return;
1249   1      }
*** WARNING C280 IN LINE 910 OF mmi_src\mmi_ms.c: 'fps_val': unreferenced local variable
1250          #endif
1251          
1252          #ifdef __LOCK_RFID_CARD_SUPPORT__
1253          /*
1254          parameter: 
1255            none
1256          return :
1257            none
1258          */
1259          void mmi_ms_rfid_opt_fun(unsigned char rfid_val)
1260          {
1261   1        RET_VAL retval = RET_SUCESS;
1262   1        unsigned char index = 0;
1263   1        SYS_BASE_STATUS status = mmi_dq_ms_get_sys_state();
1264   1      
1265   1        if (status == SYS_STATUS_LOW_POWER)
1266   1        {
1267   2          mmi_dq_aud_stop();
1268   2          mmi_dq_aud_play_with_id(AUD_ID_LOW_BATTERY);
1269   2      #ifdef __LOCK_WIFI_SUPPORT__
1270   2          mmi_dq_wifi_lowpower_alarm();
1271   2      #endif
1272   2          return;
1273   2        }
1274   1        else if (status == SYS_STATUS_WAIT_FOR_ENTER_SLEEP)
1275   1          mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
1276   1      
1277   1        if ((status != SYS_STATUS_INPUT_RFID && status != SYS_STATUS_ADD_RFID && status != SYS_STATUS_DEL_RFID)
1278   1      #ifdef __FACTORY_TEST_SUPPORT__
1279   1          || (status == SYS_STATUS_FM_MODE && STR_ID_RF_CARD != mmi_dq_factory_mode_get_test_project())
1280   1      #endif
1281   1        )
1282   1          return;
1283   1      
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 22  

1284   1      #ifdef __LOCK_AUDIO_SUPPORT__
1285   1        mmi_dq_aud_stop();
1286   1      #endif
1287   1      
1288   1        if (mmi_dq_sys_door_state_check() == 1)
1289   1        {
1290   2          mmi_dq_aud_play_with_id(AUD_ID_RONG_TIMES_EXCEED);
1291   2      #ifdef __LOCK_WIFI_SUPPORT__
1292   2          mmi_dq_wifi_rfid_alarm();
1293   2      #endif
1294   2          return;
1295   2        }
1296   1      #ifdef __FACTORY_TEST_SUPPORT__
1297   1        if (status == SYS_STATUS_FM_MODE)
1298   1        {
1299   2          retval = mmi_dq_rfid_gen_char(opt_time);
1300   2          if (retval == RET_SUCESS)
1301   2          {
1302   3            if (opt_time == OPT_ONE_TIME)
1303   3            {
1304   4              mmi_dq_aud_play_with_id(AUD_ID_PRESS_RFCARD_AGAIN);
1305   4              opt_time = OPT_TWO_TIME;
1306   4            }
1307   3            else
1308   3            {
1309   4              retval = mmi_dq_rfid_match();
1310   4              if (retval == RET_SUCESS)
1311   4      
1312   4                mmi_dq_factory_mode_test_item_result(STR_ID_RF_CARD, 1);
1313   4              else
1314   4                mmi_dq_aud_play_with_id(AUD_ID_RFCARD_TWICE_NOT_SAME_RETRY);
1315   4              opt_time = OPT_ONE_TIME;
1316   4            }
1317   3          }
1318   2          return;
1319   2        }
1320   1      #endif
1321   1        retval = mmi_dq_rfid_search_by_temp(&index);
1322   1        if (retval == RET_SUCESS)
1323   1        {
1324   2          if (status == SYS_STATUS_INPUT_RFID)
1325   2          {
1326   3            mmi_dq_sys_door_open(SYS_OPEN_BY_RFID);
1327   3          }
1328   2          else if (status == SYS_STATUS_ADD_RFID)
1329   2          {
1330   3            mmi_dq_aud_play_with_id(AUD_ID_RFCARD_EXIST);
1331   3          }
1332   2          else if (status == SYS_STATUS_DEL_RFID)
1333   2          {
1334   3            retval = mmi_dq_rfid_gen_char(opt_time);
1335   3            if (retval == RET_SUCESS)
1336   3            {
1337   4              if (opt_time == OPT_ONE_TIME)
1338   4              {
1339   5                mmi_dq_aud_play_with_id(AUD_ID_PRESS_DEL_RFCARD_AGAIN);
1340   5                opt_time = OPT_TWO_TIME;
1341   5              }
1342   4              else
1343   4              {
1344   5                retval = mmi_dq_rfid_match();
1345   5                if (retval == RET_SUCESS)
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 23  

1346   5                {
1347   6                  retval = mmi_dq_fs_del_rfid(index);
1348   6                  if (retval == RET_SUCESS)
1349   6                  {
1350   7                    get_index = index;
1351   7                    mmi_dq_aud_play_with_id(AUD_ID_DEL_RFCARD_SUCESS);
1352   7      #ifdef __LOCK_WIFI_SUPPORT__
1353   7                    mmi_dq_wifi_del_rfid_suc(get_index);
1354   7      #endif
1355   7                    // printfV("get_index", (int)get_index);
1356   7                  }
1357   6                  else
1358   6                    mmi_dq_aud_play_with_id(AUD_ID_DEL_FAIL);
1359   6                  mmi_dq_sys_del_rf_con();
1360   6                }
1361   5                else
1362   5                  mmi_dq_aud_play_with_id(AUD_ID_RFCARD_TWICE_NOT_SAME_RETRY);
1363   5                opt_time = OPT_ONE_TIME;
1364   5              }
1365   4            }
1366   3            else
1367   3              mmi_dq_aud_play_with_id(AUD_ID_DEL_FAIL_RETRY);
1368   3          }
1369   2        }
1370   1        else
1371   1        {
1372   2          if (status == SYS_STATUS_ADD_RFID)
1373   2          {
1374   3            retval = mmi_dq_rfid_gen_char(opt_time);
1375   3            if (retval == RET_SUCESS)
1376   3            {
1377   4              if (opt_time == OPT_ONE_TIME)
1378   4              {
1379   5                mmi_dq_aud_play_with_id(AUD_ID_PRESS_RFCARD_AGAIN);
1380   5                opt_time = OPT_TWO_TIME;
1381   5              }
1382   4              else
1383   4              {
1384   5                retval = mmi_dq_rfid_match();
1385   5                if (retval == RET_SUCESS)
1386   5                {
1387   6                  retval = mmi_dq_rfid_store(0);
1388   6                  if (retval == RET_SUCESS)
1389   6                  {
1390   7                    mmi_dq_aud_play_with_id(AUD_ID_ADD_RFCARD_SUCESS);
1391   7      #ifdef __LOCK_WIFI_SUPPORT__
1392   7                    mmi_dq_wifi_add_rfid_suc(get_index);
1393   7      #endif
1394   7                    // printfV("get_index", (int)get_index);
1395   7                  }
1396   6                  else
1397   6                    mmi_dq_aud_play_with_id(AUD_ID_ADD_FAIL);
1398   6      #ifdef __LOCK_WIFI_SUPPORT__
1399   6                  if (wifi_add_flag == 0)
1400   6                  {
1401   7                    wifi_add_flag = 0;
1402   7                    mmi_dq_ms_set_sys_state(SYS_STATUS_IDLE);
1403   7                  }
1404   6                  else
1405   6      #endif
1406   6                    mmi_dq_sys_add_rf_con();
1407   6                }
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 24  

1408   5                else
1409   5                  mmi_dq_aud_play_with_id(AUD_ID_RFCARD_TWICE_NOT_SAME_RETRY);
1410   5                opt_time = OPT_ONE_TIME;
1411   5              }
1412   4            }
1413   3            else
1414   3              mmi_dq_aud_play_with_id(AUD_ID_ADD_FAIL_RETRY);
1415   3          }
1416   2          else if (status == SYS_STATUS_INPUT_RFID)
1417   2            mmi_dq_sys_door_open_fail(SYS_OPEN_BY_RFID);
1418   2          else
1419   2            mmi_dq_aud_play_with_id(AUD_ID_RFCARD_NOT_EXIST);
1420   2        }
1421   1      
1422   1        return;
1423   1      }
*** WARNING C280 IN LINE 1259 OF mmi_src\mmi_ms.c: 'rfid_val': unreferenced local variable
1424          #endif
1425          
1426          /*
1427          parameter: 
1428            none
1429          return :
1430            none
1431          */
1432          void mmi_ms_reset_opt_fun(void)
1433          {
1434   1        SYS_BASE_STATUS status = mmi_dq_ms_get_sys_state();
1435   1      
1436   1        if (status == SYS_STATUS_FM_MODE
1437   1      #ifdef __FACTORY_TEST_SUPPORT__
1438   1          && STR_ID_RESET == mmi_dq_factory_mode_get_test_project()
1439   1      #endif
1440   1        )
1441   1        {
1442   2      #ifdef __FACTORY_TEST_SUPPORT__
1443   2          mmi_dq_factory_mode_reset_test();
1444   2      #endif
1445   2          return;
1446   2        }
1447   1        else
1448   1        {
1449   2          if (RET_SUCESS == mmi_dq_fs_reset())
1450   2          {
1451   3            mmi_dq_aud_play_with_id(AUD_ID_RESTORE_SUCESS);
1452   3      #ifdef __LOCK_WIFI_SUPPORT__
1453   3            mmi_dq_wifi_clr_pwd_suc();
1454   3            mmi_dq_wifi_clr_fps_suc();
1455   3            mmi_dq_wifi_clr_rfid_suc();
1456   3      #endif
1457   3          }
1458   2          else
1459   2            mmi_dq_aud_play_with_id(AUD_BASE_ID_FAIL);
1460   2      
1461   2          mmi_dq_sys_add_admin_pwd();
1462   2        }
1463   1      }
1464          
1465          #ifdef __LOCK_WIFI_SUPPORT__
1466          /*
1467          parameter: 
1468            none
C51 COMPILER V9.59.0.0   MMI_MS                                                            04/19/2021 10:41:15 PAGE 25  

1469          return :
1470            none
1471          */
1472          void mmi_ms_wifi_opt_fun(void)
1473          {
1474   1        unsigned char type = mmi_dq_sys_get_wifi_check_type();
1475   1        if (type == 0)
1476   1          mmi_dq_wifi_check_connect();
1477   1        else if (type == 1)
1478   1          mmi_dq_wifi_check_open();
1479   1      }
1480          #endif
1481          #endif //__MMI_MS_C__


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   4163    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     74      21
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
